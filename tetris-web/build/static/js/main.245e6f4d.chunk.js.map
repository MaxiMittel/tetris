{"version":3,"sources":["types.ts","components/Navbar.tsx","assets/logo_text.png","api/endpoint.ts","api/account.ts","components/SignIn.tsx","api/ping.ts","api/lobby.ts","components/Lobbies.tsx","components/SignUp.tsx","components/Account.tsx","api/user.ts","components/Authenticated.tsx","tetris/blocks.ts","tetris/shapes.ts","tetris/collision.ts","components/Canvas.tsx","components/Tetris.tsx","components/Chat.tsx","components/LobbyInfo.tsx","components/TetrisSocket.tsx","components/Search.tsx","api/search.ts","App.tsx","reportWebVitals.ts","index.tsx"],"names":["Colors","Shape","Rotation","Navbar","props","openLink","authenticated","window","location","href","className","src","alt","type","onClick","buttonText","id","children","DIRECTORY_SERVICE","ENDPOINT","requestEndpoint","Promise","resolve","reject","axios","get","then","response","loadBalancers","data","server","map","lb","ip","port","Math","floor","random","length","catch","error","console","log","getGameServers","gameServers","gs","signup","username","password","endpoint","post","signin","SignIn","React","useState","setUsername","setPassword","loginSuccessfull","setLoginSuccessfull","onSubmit","e","a","preventDefault","localStorage","setItem","auth","onAuthenticated","err","htmlFor","placeholder","required","value","onChange","target","pingAllServers","servers","all","start","Date","now","ping","undefined","pingServer","getBestServer","exclude","acceptableServers","sort","b","filter","getLobbies","deleteLobby","Lobbies","lobbyName","setLobbyName","lobbies","setLobbies","useEffect","sessions","interval","setInterval","clearInterval","lobby","index","players","name","code","res","LobbyItem","SignUp","confirmPassword","setConfirmPassword","passwordValid","setPasswordValid","passwordsMatch","setPasswordsMatch","usernameAvailable","setUsernameAvailable","passwordIsValid","passwordLengthValid","passwordContainsCaps","match","passwordContainsDigit","Account","hsData","setHsData","bpmData","setBpmData","highscore","setHighscore","useParams","userID","headers","Authorization","getItem","params","repsonse","userInfo","stats","generateDiagramData","game","score","bpm","options","chartOptions","label","color","labels","datasets","fill","borderColor","tension","plugins","title","display","legend","Authenticated","blockList","PURPLE","shape","T","rotation","UP","x","y","CYAN","BAR","BLUE","L","ORANGE","DOWN","YELLOW","BLOCK","RED","Z","GREEN","randomBlock","shapeToCoordinates","RIGHT","LEFT","TShape","LShape","ZShape","BarShape","BlockShape","drawShape","player","field","shapeToDraw","fieldCopy","arr","slice","forEach","evalCollision","xOffset","yOffset","coordinates","outOfBoundsTop","some","outOfBoundsLeft","outOfBoundsRight","outOfBoundsBottom","outOfBounds","collision","EMPTY","top","left","right","bottom","combined","Canvas","canvasRef","useRef","blockSize","width","height","canvas","current","ctx","getContext","clearRect","fillStyle","strokeStyle","lineWidth","fillRect","strokeRect","i","block","font","fillText","draw","cancelAnimationFrame","animation","ref","Tetris","gamefieldDisplay","setGameFieldDisplay","drawInterval","fixPositionTimer","lastMoveDown","onBlockFix","onPlayerMove","moveDown","useCallback","newField","clearTimeout","setTimeout","onKeyDownHandler","event","key","newRotation","legalPosition","yOff","xOff","yDiff","addEventListener","removeEventListener","Chat","msg","setMsg","sendMessage","onMessage","userId","message","messages","LobbyInfo","tab","setTab","ready","fieldSize","TetrisSocket","room","initPlayer","randInt","setPlayer","setPlayers","genEmptyField","setField","chatMessages","setChatMessages","playerReady","setPlayerReady","gameRunning","setGameRunning","gameOver","setGameOver","lobbyText","setLobbyText","socketAddress","setSocketAddress","socket","setSocket","startTime","blockFixCount","newSocket","io","close","on","emit","old","gamescore","passedTime","time","onReady","p","newPlayer","min","max","f","Array","Search","query","setQuery","results","setResults","search","users","style","padding","result","SearchResult","App","halfmoon","require","onDOMContentLoaded","isAuth","setAuth","path","component","exact","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.245e6f4d.chunk.js","sourcesContent":["export type Lobby = {\n  name: string;\n  players: number;\n  id: string;\n};\n\nexport enum Colors {\n  EMPTY,\n  ORANGE,\n  GREEN,\n  RED,\n  YELLOW,\n  BLUE,\n  CYAN,\n  PURPLE,\n}\n\nexport enum Shape {\n  BLOCK,\n  BAR,\n  Z,\n  L,\n  T,\n}\n\nexport enum Rotation {\n  UP,\n  RIGHT,\n  DOWN,\n  LEFT,\n}\n\nexport type Block = {\n  color: Colors;\n  shape: Shape;\n  rotation: Rotation;\n  x: number;\n  y: number;\n};\n\nexport type PlayerEntry = {\n  id: string;\n  username: string;\n  block: Block;\n  ready: boolean;\n};\n\nexport type ChatMessage = {\n  id: string;\n  message: string;\n};\n\nexport type SocketAddress = {\n  ip: string;\n  port: number;\n  ping?: number;\n};\n","import React from \"react\";\nimport logo from \"../assets/logo_text.png\";\n\ninterface Props {\n  authenticated: boolean;\n  buttonText: string;\n  children: any;\n}\n\nexport const Navbar: React.FC<Props> = (props: Props) => {\n  const openLink = () => {\n    if (props.authenticated) {\n      window.location.href = \"/account\";\n    } else {\n      window.location.href = \"/signin\";\n    }\n  };\n\n  return (\n    <div>\n      <div className=\"page-wrapper with-navbar\">\n        <nav className=\"navbar\">\n          <a href=\"/\" className=\"navbar-brand\">\n            <img\n              src={logo}\n              alt=\"logo\"\n            />\n          </a>\n          <ul className=\"navbar-nav d-none d-md-flex\">\n            <li className=\"nav-item active\">\n              <a href=\"/\" className=\"nav-link\">\n                Play\n              </a>\n            </li>\n            <li className=\"nav-item\">\n              <a href=\"/search\" className=\"nav-link\">\n                Search\n              </a>\n            </li>\n          </ul>\n          <div className=\"form-inline d-none d-md-flex ml-auto\">\n            <button\n              className=\"btn btn-primary\"\n              type=\"submit\"\n              onClick={openLink}\n            >\n              {props.buttonText}\n            </button>\n          </div>\n          <div className=\"navbar-content d-md-none ml-auto\">\n            <div className=\"dropdown with-arrow\">\n              <button\n                className=\"btn\"\n                data-toggle=\"dropdown\"\n                type=\"button\"\n                id=\"navbar-dropdown-toggle-btn-1\"\n              >\n                Menu\n                <i className=\"fa fa-angle-down\" aria-hidden=\"true\"></i>\n              </button>\n              <div\n                className=\"dropdown-menu dropdown-menu-right w-200\"\n                aria-labelledby=\"navbar-dropdown-toggle-btn-1\"\n              >\n                <a href=\"/\" className=\"dropdown-item\">\n                  Play\n                </a>\n                <a href=\"/search\" className=\"dropdown-item\">\n                  Search\n                </a>\n                <div className=\"dropdown-divider\"></div>\n                <div className=\"dropdown-content\">\n                  <button\n                    className=\"btn btn-primary btn-block\"\n                    type=\"submit\"\n                    onClick={openLink}\n                  >\n                    {props.buttonText}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </nav>\n\n        <div className=\"content-wrapper\">{props.children}</div>\n      </div>\n    </div>\n  );\n};\n","export default \"data:image/png;base64,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\"","import axios from \"axios\";\n\nconst DIRECTORY_SERVICE = \"http://18.192.65.75:7777\";\nexport var ENDPOINT = \"\";\n\nexport const requestEndpoint = () => {\n  return new Promise((resolve, reject) => {\n    if (ENDPOINT !== \"\") {\n      resolve(ENDPOINT);\n    } else {\n      axios\n        .get(`${DIRECTORY_SERVICE}/directory-service/getlb`)\n        .then((response) => {\n          // Get all available load balancers\n          const loadBalancers = response.data.server.map((lb: any) => {\n            return `http://${lb.ip}:${lb.port}`;\n          });\n\n          // Choose a random load balancer\n          ENDPOINT =\n            loadBalancers[Math.floor(Math.random() * loadBalancers.length)];\n\n          resolve(ENDPOINT);\n        })\n        .catch((error) => {\n          console.log(error);\n          reject();\n        });\n    }\n  });\n};\n\nexport const getGameServers = () => {\n  return new Promise((resolve, reject) => {\n    axios\n      .get(`${DIRECTORY_SERVICE}/directory-service/getgs`)\n      .then((response) => {\n        // Get all available load balancers\n        const gameServers = response.data.server.map((gs: any) => {\n          return {ip: gs.ip, port: gs.port};\n        });\n\n        resolve(gameServers);\n      })\n      .catch((error) => {\n        console.log(error);\n        reject();\n      });\n  });\n}","import axios from \"axios\";\nimport { requestEndpoint } from \"./endpoint\";\n\nexport const signup = (username: string, password: string) => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.post(`${endpoint}/api/account/signup`, {\n      username,\n      password,\n    });\n  });\n};\n\nexport const signin = (username: string, password: string) => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.post(`${endpoint}/api/account/signin`, {\n      username,\n      password,\n    });\n  });\n};\n\nexport const isAuthenticated = () => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.get(`${endpoint}/api/account/isAuthenticated`, {\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(\"auth\")}`,\n      },\n    });\n  });\n};\n\nexport const getAuthenticatedUser = () => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.get(`${endpoint}/api/user/get`, {\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(\"auth\")}`,\n      },\n    });\n  });\n};\n\nexport const updateUserStats = (gamescore: any) => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.post(`${endpoint}/api/account/poststat`, {\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(\"auth\")}`,\n      },\n      data: {\n        gamescore\n      }\n    });\n  });\n}","import React from \"react\";\nimport { signin } from \"../api/account\";\n\ninterface Props {\n  onAuthenticated: () => void;\n}\n\nexport const SignIn: React.FC<Props> = (props: Props) => {\n  const [username, setUsername] = React.useState(\"\");\n  const [password, setPassword] = React.useState(\"\");\n\n  const [loginSuccessfull, setLoginSuccessfull] = React.useState(true);\n\n  //Submit the form\n  const onSubmit = async (e: any) => {\n    e.preventDefault();\n\n    signin(username, password)\n      .then(response => {\n\n        console.log(response.data);\n        \n        setLoginSuccessfull(true);\n        localStorage.setItem(\"auth\", response.data.auth);\n        localStorage.setItem(\"username\", response.data.username);\n        localStorage.setItem(\"userId\", response.data.id);\n        props.onAuthenticated();\n        window.location.href = \"/\";\n      })\n      .catch((err) => {\n        setLoginSuccessfull(false);\n        console.log(err);\n      });\n  };\n\n  return (\n    <div className=\"w-400 card\">\n      <h2 className=\"card-title\">Sign In</h2>\n      <form onSubmit={onSubmit} className=\"w-400 mw-full\">\n        <div className={\"form-group\"}>\n          <label htmlFor=\"username\" className=\"required\">\n            Username\n          </label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            id=\"username\"\n            placeholder=\"Username\"\n            required\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n          />\n        </div>\n        <div\n          className={\"form-group \" + (!loginSuccessfull ? \"is-invalid\" : \"\")}\n        >\n          <label htmlFor=\"password\" className=\"required\">\n            Password\n          </label>\n          <input\n            type=\"password\"\n            className=\"form-control\"\n            id=\"password\"\n            placeholder=\"Password\"\n            required\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n          {!loginSuccessfull && (\n            <div className=\"invalid-feedback\">\n              The username or password is incorrect.\n            </div>\n          )}\n        </div>\n        <div className=\"form-group\">\n          <input\n            className=\"btn btn-primary btn-block\"\n            type=\"submit\"\n            value=\"Sign in\"\n          />\n        </div>\n        <span className=\"space-top\">\n          Don't have an account? <a href=\"/signup\">Sign up</a>\n        </span>\n      </form>\n    </div>\n  );\n};\n","import axios from \"axios\";\nimport { SocketAddress } from \"../types\";\n\nconst pingServer = (server: SocketAddress) => {\n  return new Promise((resolve, reject) => {\n    let start = Date.now();\n    axios\n      .get(`http://${server.ip}:${server.port}/ping`)\n      .then(() => {\n        resolve({ ...server, ping: Math.floor((Date.now() - start) / 10) });\n      })\n      .catch(() => resolve({ ...server, ping: undefined }));\n  });\n};\n\nconst pingAllServers = (servers: SocketAddress[]) => {\n  return Promise.all(servers.map((server) => pingServer(server)));\n};\n\nexport const getBestServer = (\n  servers: SocketAddress[],\n  exclude?: SocketAddress\n) => {\n  return pingAllServers(servers).then((servers) => {\n    console.log(\"SERVERS\", servers);\n\n    //Get all servers with a ping less than 100ms\n    let acceptableServers = servers\n      .sort((a: any, b: any) => a!.ping - b!.ping)\n      .filter((server: any) => server.ping && server.ping < 100);\n\n    console.log(\"PRE\", acceptableServers);\n\n    if (exclude) {\n      acceptableServers = acceptableServers.filter(\n        (server: any) =>\n          server.ip !== exclude.ip || server.port !== exclude.port\n      );\n    }\n\n    console.log(\"ACCEPTABLE:\", acceptableServers);\n\n    //Return random acceptable server\n    return acceptableServers[\n      Math.floor(Math.random() * acceptableServers.length)\n    ];\n  });\n};\n","import axios from \"axios\";\nimport { SocketAddress } from \"../types\";\nimport { getGameServers, requestEndpoint } from \"./endpoint\";\nimport { getBestServer } from \"./ping\";\n\nexport const getLobbies = () => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.get(`${endpoint}/api/sessions/list`);\n  });\n};\n\nexport const createLobby = (name: string) => {\n  return new Promise((resolve, reject) => {\n    requestEndpoint().then((endpoint) => {\n      getGameServers()\n        .then((servers) => {\n          getBestServer(servers as SocketAddress[])\n            .then((server) => {\n              axios\n                .post(`${endpoint}/api/sessions/allocate`, { name, server })\n                .then((res) => resolve(res))\n                .catch((err) => reject(err));\n            })\n            .catch((err) => reject(err));\n        })\n        .catch((err) => reject(err));\n    });\n  });\n};\n\nexport const getLobby = (id: string) => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.get(`${endpoint}/api/sessions/get`, { params: { id } });\n  });\n};\n\nexport const deleteLobby = (id: string, ip: string, port: number) => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.post(`${endpoint}/api/sessions/delete`, { id, ip, port });\n  });\n};\n\nexport const migrateLobby = (id: string, old: SocketAddress, name: string) => {\n  return requestEndpoint().then((endpoint) => {\n    return new Promise((resolve, reject) => {\n      getGameServers()\n        .then((servers) => {\n          getBestServer(servers as SocketAddress[], old)\n            .then((server) => {\n              console.log(\"MIG\", {\n                id,\n                name,\n                server,\n              });\n\n              axios\n                .post(`${endpoint}/api/sessions/migrate`, {\n                  id,\n                  name,\n                  server,\n                })\n                .then((res) => resolve(res))\n                .catch((err) => reject(err));\n            })\n            .catch((err) => reject(err));\n        })\n        .catch((err) => reject(err));\n    });\n  });\n};\n","import React, { useEffect } from \"react\";\nimport { createLobby, getLobbies } from \"../api/lobby\";\nimport { Lobby } from \"../types\";\n\ninterface Props {}\n\nexport const Lobbies: React.FC<Props> = (props: Props) => {\n  const [lobbyName, setLobbyName] = React.useState(\"\");\n  const [lobbies, setLobbies] = React.useState<Lobby[]>([]);\n\n  useEffect(() => {\n    getLobbies().then((response) => {\n      setLobbies(response.data.sessions);\n    });\n  }, []);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      getLobbies().then((response) => {\n        setLobbies(response.data.sessions);\n      });\n    }, 1000);\n\n    return () => { clearInterval(interval); };\n  }, []);\n\n  const onNewLobby = (e: any) => {\n    e.preventDefault();\n    createLobby(lobbyName).then((response: any) => {\n      window.location.href = `/lobby/${response.data.id}`;\n    }).catch((error) => console.log(error));\n  };\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"w-400 card\">\n          <div className=\"card-top\">\n            <h2 className=\"card-title\">Join</h2>\n          </div>\n\n          <div className=\"lobby-scroll\">\n            {lobbies.map((lobby: Lobby, index: number) => (\n              <LobbyItem\n                players={lobby.players}\n                lobbyName={lobby.name}\n                code={lobby.id}\n                key={\"lobby_item_\" + index}\n              />\n            ))}\n          </div>\n        </div>\n        <div>\n          <div className=\"w-400 card\">\n            <h2 className=\"card-title\">Create</h2>\n\n            <form onSubmit={onNewLobby} className=\"mw-full\">\n              <div className={\"form-group\"}>\n                <label htmlFor=\"lobbyName\" className=\"required\">\n                  Lobby name\n                </label>\n                <input\n                  type=\"text\"\n                  className=\"form-control\"\n                  id=\"lobbyName\"\n                  placeholder=\"e.g. Cool lobby\"\n                  required\n                  value={lobbyName}\n                  onChange={(e) => setLobbyName(e.target.value)}\n                />\n              </div>\n              <div className=\"form-group\">\n                <input\n                  className=\"btn btn-primary btn-block\"\n                  type=\"submit\"\n                  value=\"Create new\"\n                />\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\ninterface LobbyItemProps {\n  lobbyName: string;\n  players: number;\n  code: string;\n}\n\nconst LobbyItem: React.FC<LobbyItemProps> = (props: LobbyItemProps) => {\n  return (\n    <div className=\"lobby-item\">\n      <div className=\"lobby-item-text\">\n        <h2 className=\"lobby-item-heading\">{props.lobbyName}</h2>\n      </div>\n      <a href={`/lobby/${props.code}`}>\n        <button className=\"btn btn-primary\">Join</button>\n      </a>\n    </div>\n  );\n};\n","import React, { useEffect } from \"react\";\nimport { signup } from \"../api/account\";\n\ninterface Props {\n  onAuthenticated: () => void;\n}\n\nexport const SignUp: React.FC<Props> = (props: Props) => {\n  const [username, setUsername] = React.useState(\"\");\n  const [password, setPassword] = React.useState(\"\");\n  const [confirmPassword, setConfirmPassword] = React.useState(\"\");\n\n  const [passwordValid, setPasswordValid] = React.useState(true);\n  const [passwordsMatch, setPasswordsMatch] = React.useState(true);\n  const [usernameAvailable, setUsernameAvailable] = React.useState(true);\n\n  //Check if password satisifes the password requirements\n  useEffect(() => {\n    setPasswordValid(passwordIsValid(password) || password.length === 0);\n  }, [password]);\n\n  //Check if passwords match\n  useEffect(() => {\n    setPasswordsMatch(\n      password === confirmPassword || confirmPassword.length === 0\n    );\n  }, [password, confirmPassword]);\n\n  //Submit the form\n  const onSubmit = async (e: any) => {\n    e.preventDefault();\n\n    if (\n      passwordValid &&\n      passwordsMatch &&\n      password.length >= 8 &&\n      username.length > 0\n    ) {\n      signup(username, password)\n        .then((response) => {          \n          localStorage.setItem(\"auth\", response.data.auth);\n          localStorage.setItem(\"username\", response.data.username);\n          localStorage.setItem(\"userId\", response.data.id);\n          props.onAuthenticated();\n          window.location.href = \"/\";\n        })\n        .catch((err) => {\n          setUsernameAvailable(false);\n          console.log(err);\n        });\n    }\n  };\n\n  return (\n    <div className=\"w-400 card\">\n      <h2 className=\"card-title\">Sign Up</h2>\n      <form onSubmit={onSubmit} className=\"w-400 mw-full\">\n        <div\n          className={\"form-group \" + (!usernameAvailable ? \"is-invalid\" : \"\")}\n        >\n          <label htmlFor=\"username\" className=\"required\">\n            Username\n          </label>\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            id=\"username\"\n            placeholder=\"Username\"\n            required\n            value={username}\n            onChange={(e) => setUsername(e.target.value)}\n          />\n          {!usernameAvailable && (\n            <div className=\"invalid-feedback\">\n              This username is already taken.\n            </div>\n          )}\n        </div>\n        <div className={\"form-group \" + (!passwordValid ? \"is-invalid\" : \"\")}>\n          <label htmlFor=\"password\" className=\"required\">\n            Password\n          </label>\n          <input\n            type=\"password\"\n            className=\"form-control\"\n            id=\"password\"\n            placeholder=\"Password\"\n            required\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n          />\n          {!passwordValid && (\n            <div className=\"invalid-feedback\">\n              <ul>\n                <li>Password must be at least 8 characters long</li>\n                <li>Contain at least one digit (0-9)</li>\n                <li>Contain at least one uppercase letter (A-Z)</li>\n              </ul>\n            </div>\n          )}\n        </div>\n        <div className={\"form-group \" + (!passwordsMatch ? \"is-invalid\" : \"\")}>\n          <label htmlFor=\"confirm-password\" className=\"required\">\n            Confirm password\n          </label>\n          <input\n            type=\"password\"\n            className=\"form-control\"\n            id=\"confirm-password\"\n            placeholder=\"Confirm password\"\n            required\n            value={confirmPassword}\n            onChange={(e) => setConfirmPassword(e.target.value)}\n          />\n          {!passwordsMatch && (\n            <div className=\"invalid-feedback\">The passwords don't match.</div>\n          )}\n        </div>\n        <div className=\"form-group\">\n          <input\n            className=\"btn btn-primary btn-block\"\n            type=\"submit\"\n            value=\"Sign up\"\n          />\n        </div>\n        <span className=\"space-top\">\n          Already have an account? <a href=\"/signin\">Sign in</a>\n        </span>\n      </form>\n    </div>\n  );\n};\n\n/**\n * Checks if the password fullfills the requirements.\n * @param password The password to validate\n * @returns true if the password is valid, false otherwise\n */\nconst passwordIsValid = (password: string) => {\n  const passwordLengthValid = password.length >= 8;\n  const passwordContainsCaps = password.match(/[A-Z]/) !== null;\n  const passwordContainsDigit = password.match(/\\d/) !== null;\n\n  return passwordLengthValid && passwordContainsCaps && passwordContainsDigit;\n};\n","import React, { useEffect } from \"react\";\nimport { Line } from \"react-chartjs-2\";\nimport { useParams } from \"react-router\";\nimport { getAuthenticatedUser } from \"../api/account\";\nimport { getUser } from \"../api/user\";\n\ninterface Props {}\n\nexport const Account: React.FC<Props> = (props: Props) => {\n  const [hsData, setHsData] = React.useState<object | undefined>(undefined);\n  const [bpmData, setBpmData] = React.useState<object | undefined>(undefined);\n  const [username, setUsername] = React.useState<string>(\"\");\n  const [highscore, setHighscore] = React.useState<number>(0);\n\n  const { id } = useParams<any>();\n\n  useEffect(() => {\n    const userInfoPromise = id ? getUser(id) : getAuthenticatedUser();\n\n    userInfoPromise\n      .then((repsonse: any) => {\n        const userInfo = repsonse.data;\n        setUsername(userInfo.username);\n        setHighscore(userInfo.highscore);        \n\n        if (userInfo.stats.length > 0) {\n          setHsData(\n            generateDiagramData(\"Highscore\",\n              userInfo.stats.map((game: any) => game.score),\n              \"#D11149\"\n            )\n          );\n          setBpmData(\n            generateDiagramData(\"Blocks per minute\",\n              userInfo.stats.map((game: any) => game.bpm),\n              \"#6610F2\"\n            )\n          );\n        }\n      })\n      .catch((error: any) => console.log(error));\n  }, [id]);\n\n  return (\n    <div className=\"container-fluid\">\n      <div className=\"row\">\n        <div className=\"col-lg-3\">\n          <div className=\"card\">\n            <h2 className=\"card-title\">{username}</h2>\n            <p>Highscore: {highscore}</p>\n          </div>\n        </div>\n        <div className=\"col-lg-9\">\n          <div className=\"card\">\n            <h2 className=\"card-title\">Highscores</h2>\n            {hsData && <Line data={hsData} options={chartOptions} />}\n            {!hsData && <p>No highscores</p>}\n          </div>\n          <div className=\"card\">\n            <h2 className=\"card-title\">Blocks per minute</h2>\n            {bpmData && <Line data={bpmData} options={chartOptions} />}\n            {!bpmData && <p>No bpm data</p>}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// Generate a data object for the chart\nconst generateDiagramData = (label: string, data: any[], color: string) => {\n  if (data.length === 0) {\n    return undefined;\n  }\n\n  return {\n    labels: [\"-\", \"-\", \"-\", \"-\", \"-\", \"-\", \"-\"],\n    datasets: [\n      {\n        label,\n        data,\n        fill: true,\n        borderColor: color,\n        tension: 0.1,\n      },\n    ],\n  };\n};\n\nconst chartOptions = {\n  plugins: {\n    title: {\n      display: false,\n    },\n    legend: {\n      display: false,\n    },\n  },\n};\n","import axios from \"axios\";\nimport { requestEndpoint } from \"./endpoint\";\n\nexport const getUser = (userID: number) => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.get(`${endpoint}/api/user/getbyid`, {\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(\"auth\")}`,\n      },\n      params: {\n        id: userID,\n      },\n    });\n  });\n};\n","import React from \"react\";\nimport { SignIn } from \"./SignIn\";\n\ninterface Props {\n  children: React.ReactNode;\n  authenticated: boolean;\n  onAuthenticated: () => void;\n}\n\nexport const Authenticated: React.FC<Props> = (props: Props) => {\n  return (\n    <div>\n      {props.authenticated && props.children}\n      {!props.authenticated && <SignIn onAuthenticated={props.onAuthenticated} />}\n    </div>\n  );\n};\n","import { Colors, Rotation, Shape } from \"../types\";\n\nconst blockList = [\n  {\n    color: Colors.PURPLE,\n    shape: Shape.T,\n    rotation: Rotation.UP,\n    x: 0,\n    y: 0,\n  },\n  {\n    color: Colors.CYAN,\n    shape: Shape.BAR,\n    rotation: Rotation.UP,\n    x: 0,\n    y: 0,\n  },\n  {\n    color: Colors.BLUE,\n    shape: Shape.L,\n    rotation: Rotation.UP,\n    x: 0,\n    y: 0,\n  },\n  {\n    color: Colors.ORANGE,\n    shape: Shape.L,\n    rotation: Rotation.DOWN,\n    x: 0,\n    y: 0,\n  },\n  {\n    color: Colors.YELLOW,\n    shape: Shape.BLOCK,\n    rotation: Rotation.UP,\n    x: 0,\n    y: 0,\n  },\n  {\n    color: Colors.RED,\n    shape: Shape.Z,\n    rotation: Rotation.UP,\n    x: 0,\n    y: 0,\n  },\n  {\n    color: Colors.GREEN,\n    shape: Shape.Z,\n    rotation: Rotation.DOWN,\n    x: 0,\n    y: 0,\n  },\n];\n\nexport const randomBlock = (x: number) => {\n  const index = Math.floor(Math.random() * blockList.length);\n  const block = {...blockList[index], x};\n  return block;\n};\n","import { Block, Colors, Rotation, Shape } from \"../types\";\n\n/**\n * Draws a T-shape.\n * @param x x-coordinate of the top-left corner of the shape.\n * @param y y-coordinate of the top-left corner of the shape.\n * @param rotation Rotation of the shape.\n * @returns Array of coordinates of the shape.\n */\nexport const TShape = (x: number, y: number, rotation: Rotation) => {\n  switch (rotation) {\n    case Rotation.UP:\n      return [\n        { x: x, y: y },\n        { x: x + 1, y: y },\n        { x: x + 2, y: y },\n        { x: x + 1, y: y + 1 },\n      ];\n    case Rotation.RIGHT:\n      return [\n        { x: x, y: y },\n        { x: x, y: y + 1 },\n        { x: x, y: y + 2 },\n        { x: x + 1, y: y + 1 },\n      ];\n    case Rotation.DOWN:\n      return [\n        { x: x, y: y + 1 },\n        { x: x + 1, y: y + 1 },\n        { x: x + 2, y: y + 1 },\n        { x: x + 1, y: y },\n      ];\n    case Rotation.LEFT:\n      return [\n        { x: x + 1, y: y },\n        { x: x + 1, y: y + 1 },\n        { x: x + 1, y: y + 2 },\n        { x: x, y: y + 1 },\n      ];\n  }\n};\n\n/**\n * Draws a L-shape.\n * @param x x-coordinate of the top-left corner of the shape.\n * @param y y-coordinate of the top-left corner of the shape.\n * @param rotation Rotation of the shape.\n * @returns Array of coordinates of the shape.\n */\nexport const LShape = (x: number, y: number, rotation: Rotation) => {\n  switch (rotation) {\n    case Rotation.UP:\n      return [\n        { x: x, y: y },\n        { x: x, y: y + 1 },\n        { x: x + 1, y: y + 1 },\n        { x: x + 2, y: y + 1 },\n      ];\n    case Rotation.RIGHT:\n      return [\n        { x: x, y: y },\n        { x: x + 1, y: y },\n        { x: x, y: y + 1 },\n        { x: x, y: y + 2 },\n      ];\n    case Rotation.DOWN:\n      return [\n        { x: x, y: y },\n        { x: x + 1, y: y },\n        { x: x + 2, y: y },\n        { x: x + 2, y: y + 1 },\n      ];\n    case Rotation.LEFT:\n      return [\n        { x: x + 1, y: y },\n        { x: x + 1, y: y + 1 },\n        { x: x + 1, y: y + 2 },\n        { x: x, y: y + 2 },\n      ];\n  }\n};\n\n/**\n * Draws a Z-shape.\n * @param x x-coordinate of the top-left corner of the shape.\n * @param y y-coordinate of the top-left corner of the shape.\n * @param rotation Rotation of the shape.\n * @returns Array of coordinates of the shape.\n */\nexport const ZShape = (x: number, y: number, rotation: Rotation) => {\n  switch (rotation) {\n    case Rotation.UP:\n      return [\n        { x: x + 1, y: y },\n        { x: x, y: y + 1 },\n        { x: x + 1, y: y + 1 },\n        { x: x, y: y + 2 },\n      ];\n    case Rotation.RIGHT:\n      return [\n        { x: x + 1, y: y },\n        { x: x, y: y },\n        { x: x + 1, y: y + 1 },\n        { x: x + 2, y: y + 1 },\n      ];\n    case Rotation.DOWN:\n      return [\n        { x: x, y: y },\n        { x: x, y: y + 1 },\n        { x: x + 1, y: y + 1 },\n        { x: x + 1, y: y + 2 },\n      ];\n    case Rotation.LEFT:\n      return [\n        { x: x + 1, y: y },\n        { x: x, y: y + 1 },\n        { x: x + 1, y: y + 1 },\n        { x: x + 2, y: y },\n      ];\n  }\n};\n\n/**\n * Draws an Bar-shape.\n * @param x x-coordinate of the top-left corner of the shape.\n * @param y y-coordinate of the top-left corner of the shape.\n * @param rotation Rotation of the shape.\n * @returns Array of coordinates of the shape.\n */\nexport const BarShape = (x: number, y: number, rotation: Rotation) => {\n  switch (rotation) {\n    case Rotation.UP:\n    case Rotation.DOWN:\n      return [\n        { x: x, y: y },\n        { x: x + 1, y: y },\n        { x: x + 2, y: y },\n        { x: x + 3, y: y },\n      ];\n    case Rotation.RIGHT:\n    case Rotation.LEFT:\n      return [\n        { x: x, y: y },\n        { x: x, y: y + 1 },\n        { x: x, y: y + 2 },\n        { x: x, y: y + 3 },\n      ];\n  }\n};\n\n/**\n * Draws a Block-shape.\n * @param x x-coordinate of the top-left corner of the shape.\n * @param y y-coordinate of the top-left corner of the shape.\n * @param rotation Rotation of the shape.\n * @returns Array of coordinates of the shape.\n */\nexport const BlockShape = (x: number, y: number, rotation: Rotation) => {\n  return [\n    { x: x, y: y },\n    { x: x, y: y + 1 },\n    { x: x + 1, y: y },\n    { x: x + 1, y: y + 1 },\n  ];\n};\n\n/**\n * Will return the coordinates of the shape provided in the parameter.\n * @param x x-coordinate of the top-left corner of the shape.\n * @param y y-coordinate of the top-left corner of the shape.\n * @param shape The requested shape.\n * @param rotation Rotation of the shape.\n * @returns Array of coordinates of the shape.\n */\nexport const shapeToCoordinates = (\n  x: number,\n  y: number,\n  shape: Shape,\n  rotation: Rotation\n) => {\n  switch (shape) {\n    case Shape.T:\n      return TShape(x, y, rotation);\n    case Shape.L:\n      return LShape(x, y, rotation);\n    case Shape.Z:\n      return ZShape(x, y, rotation);\n    case Shape.BAR:\n      return BarShape(x, y, rotation);\n    case Shape.BLOCK:\n      return BlockShape(x, y, rotation);\n    default:\n      return [];\n  }\n};\n\n/**\n * Draws a shape onto a field of Colors.\n * @param field     The field to draw the shape on.\n * @param x         x-coordinate of the top-left corner of the shape.\n * @param y         y-coordinate of the top-left corner of the shape.\n * @param color     Color of the shape.\n * @param shape     The shape to draw.\n * @param rotation  Rotation of the shape.\n * @returns         A copy of the field with the shape drawn on it.\n */\nexport const drawShape = (player: Block, field: Colors[][]) => {\n  let shapeToDraw: { x: number; y: number }[] = shapeToCoordinates(\n    player.x,\n    player.y,\n    player.shape,\n    player.rotation\n  );\n\n  let fieldCopy = field.map(function (arr) {\n    return arr.slice();\n  });\n\n  shapeToDraw.forEach(({ x, y }) => {\n    try{\n      fieldCopy[y][x] = player.color;\n    }catch(e){\n      console.log(e);\n    }\n  });\n\n  return fieldCopy;\n};\n","import { Block, Colors } from \"../types\";\nimport { shapeToCoordinates } from \"./shapes\";\n\n/**\n * Evaluates if a shape is colliding with the or another shape.\n * @param x         The x coordinate of the shape.\n * @param y         The y coordinate of the shape.\n * @param shape     The shape to evaluate.\n * @param field     The field to evaluate against.\n * @param rotation  The rotation of the shape.\n * @returns         Object with the following properties:\n *                      - outOfBounds: Shape will leave the bounds of the field.\n *                      - collision: Shape collides with another shape or the bottom.\n *                      - combined: Combined boolean of the both properties.\n */\nexport const evalCollision = (\n  player: Block,\n  field: Colors[][],\n  xOffset: number,\n  yOffset: number,\n  rotation?: number\n) => {\n  const coordinates = shapeToCoordinates(\n    player.x + xOffset,\n    player.y + yOffset,\n    player.shape,\n    rotation || player.rotation\n  );\n\n  const outOfBoundsTop = coordinates.some(({ x, y }) => {\n    return y < 0;\n  });\n\n  const outOfBoundsLeft = coordinates.some(({ x, y }) => {\n    return x < 0;\n  });\n\n  const outOfBoundsRight = coordinates.some(({ x, y }) => {\n    return x > field[0].length - 1;\n  });\n\n  const outOfBoundsBottom = coordinates.some(({ x, y }) => {\n    return y > field.length - 1;\n  });\n\n  const outOfBounds =\n    outOfBoundsTop || outOfBoundsLeft || outOfBoundsRight || outOfBoundsBottom;\n\n  if (!outOfBounds) {\n    let collision = coordinates.some(\n      ({ x, y }) => field[y][x] !== Colors.EMPTY\n    );\n\n    collision = collision || coordinates.some(({ x, y }) => y >= field.length);\n\n    return {\n      outOfBounds: {\n        top: outOfBoundsTop,\n        left: outOfBoundsLeft,\n        right: outOfBoundsRight,\n        bottom: outOfBoundsBottom,\n      },\n      collision,\n      combined: outOfBounds || collision,\n    };\n  }\n\n  return {\n    outOfBounds: {\n      top: outOfBoundsTop,\n      left: outOfBoundsLeft,\n      right: outOfBoundsRight,\n      bottom: outOfBoundsBottom,\n    },\n    collision: false || coordinates.some(({ x, y }) => y >= field.length),\n    combined: true,\n  };\n};\n","import React, { useEffect, useRef } from \"react\";\nimport { Colors, PlayerEntry } from \"../types\";\n\ninterface Props {\n  width: number;\n  height: number;\n  field: Colors[][];\n  players: PlayerEntry[];\n  blockSize: number;\n}\n\nexport const Canvas: React.FC<Props> = (props: Props) => {\n  const canvasRef = useRef<HTMLCanvasElement | null>(null);\n  const { field, blockSize, width, height, players } = props;\n\n  /**\n   * Render loop\n   */\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    let animation: any;\n\n    /**\n     * Render field of Colors to the canvas\n     * @param ctx Canvas context\n     */\n    const draw = (ctx: any) => {\n      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n      ctx.fillStyle = \"#0d1a48\";\n\n      for (let x = 0; x < field[0].length; x++) {\n        for (let y = 0; y < field.length; y++) {\n          if (field[y][x] === Colors.EMPTY) continue;\n\n          const LINE_WIDTH = 3;\n          ctx.strokeStyle = \"#0d1a48\";\n          ctx.lineWidth = LINE_WIDTH;\n\n          switch (field[y][x]) {\n            case Colors.ORANGE:\n              ctx.fillStyle = \"#e56d23\";\n              break;\n            case Colors.GREEN:\n              ctx.fillStyle = \"#16cc40\";\n              break;\n            case Colors.RED:\n              ctx.fillStyle = \"#d23542\";\n              break;\n            case Colors.YELLOW:\n              ctx.fillStyle = \"#f7ca18\";\n              break;\n            case Colors.BLUE:\n              ctx.fillStyle = \"#4a68dd\";\n              break;\n            case Colors.CYAN:\n              ctx.fillStyle = \"#5cddd7\";\n              break;\n            case Colors.PURPLE:\n              ctx.fillStyle = \"#960ac3\";\n              break;\n            default:\n              ctx.fillStyle = \"#898989\";\n              break;\n          }\n\n          ctx.fillRect(x * blockSize, y * blockSize, blockSize, blockSize);\n          ctx.strokeRect(x * blockSize, y * blockSize, blockSize, blockSize);\n        }\n      }\n\n      // Draw player names\n      for (let i = 0; i < players.length; i++) {\n        const player = players[i];\n\n        if(player.block){\n          ctx.fillStyle = \"#ffffff\";\n          ctx.font = \"11px Arial\";\n          ctx.fillText(\n            `${player.username}`,\n            player.block.x * blockSize + 10,\n            player.block.y * blockSize - blockSize / 2\n          );\n          }\n      }\n\n    };\n\n    if (canvas) {\n      const ctx = canvas.getContext(\"2d\");\n      if (ctx) draw(ctx);\n    }\n\n    return () => {\n      window.cancelAnimationFrame(animation);\n    };\n  }, [field, blockSize, players]);\n\n  return (\n    <canvas\n      ref={canvasRef}\n      width={width}\n      height={height}\n      className=\"canvasContainer\"\n    />\n  );\n};\n","import React, { useCallback, useEffect, useRef } from \"react\";\nimport { evalCollision } from \"../tetris/collision\";\nimport { drawShape } from \"../tetris/shapes\";\nimport { Colors, PlayerEntry } from \"../types\";\nimport { Canvas } from \"./Canvas\";\n\ninterface Props {\n  field: Colors[][];\n  player: PlayerEntry;\n  players: PlayerEntry[];\n  onPlayerMove: (player: PlayerEntry) => void;\n  onBlockFix: (field: Colors[][]) => void;\n}\n\nexport const Tetris: React.FC<Props> = (props: Props) => {\n  const block_size = 25;\n  const [gamefieldDisplay, setGameFieldDisplay] = React.useState(props.field);\n  const drawInterval = useRef<any>();\n  const fixPositionTimer = useRef<any>();\n  const lastMoveDown = useRef<number>(Date.now());\n\n  const { field, player, players, onBlockFix, onPlayerMove } = props;\n\n  /**\n   * Move player down\n   */\n  const moveDown = useCallback(() => {\n    const collision = evalCollision(player.block, field, 0, 1);\n\n    if (!collision.combined) {\n      onPlayerMove({\n        ...player,\n        block: {\n          ...player.block,\n          y: player.block.y + 1,\n        },\n      });\n    }\n  }, [player, field, onPlayerMove]);\n\n  /**\n   * Draw the player shape on the gamefield\n   */\n  useEffect(() => {\n    drawInterval.current = setInterval(async () => {\n      //Move a block after one second\n      if (Date.now() - lastMoveDown.current > 1000) {\n        moveDown();\n        lastMoveDown.current = Date.now();\n      }\n\n      //Draw all players to the gamefield\n      let newField = drawShape(player.block, field);\n      for (let i = 0; i < players.length; i++) {\n        if (players[i].block) {\n          newField = drawShape(players[i].block, newField);\n        }\n      }\n      setGameFieldDisplay(newField);\n    }, 20);\n\n    return () => clearInterval(drawInterval.current);\n  }, [player, field, players, moveDown]);\n\n  /**\n   * Check if the player collided with other Colors or the bottom of the gamefield\n   */\n  useEffect(() => {\n    const collisionBelow = evalCollision(player.block, field, 0, 1);\n\n    if (collisionBelow.collision) {\n      clearTimeout(fixPositionTimer.current);\n      fixPositionTimer.current = setTimeout(() => {\n        onBlockFix(drawShape(player.block, field));\n      }, 500);\n    }\n\n    return () => clearTimeout(fixPositionTimer.current);\n  }, [player, field, onBlockFix]);\n\n  /**\n   * KeyDown event handler\n   * @param event Keyboard event\n   */\n  const onKeyDownHandler = useCallback(\n    (event: any) => {\n      switch (event.key) {\n        case \"ArrowDown\":\n          event.preventDefault();\n\n          const collision = evalCollision(player.block, field, 0, 1);\n\n          if (!collision.combined) {\n            onPlayerMove({\n              ...player,\n              block: { ...player.block, y: player.block.y + 1 },\n            });\n          }\n\n          break;\n        case \"ArrowLeft\":\n          event.preventDefault();\n          if (!evalCollision(player.block, field, -1, 0).combined) {\n            onPlayerMove({\n              ...player,\n              block: { ...player.block, x: player.block.x - 1 },\n            });\n          }\n          break;\n        case \"ArrowRight\":\n          event.preventDefault();\n          if (!evalCollision(player.block, field, 1, 0).combined) {\n            onPlayerMove({\n              ...player,\n              block: { ...player.block, x: player.block.x + 1 },\n            });\n          }\n          break;\n        case \"ArrowUp\":\n          event.preventDefault();\n          let newRotation = (player.block.rotation + 1) % 4;\n          let legalPosition = false;\n          let yOff = 0;\n          let xOff = 0;\n\n          //Try 10 times to get a valid position\n          for (let i = 0; i < 10; i++) {\n            const collision = evalCollision(\n              player.block,\n              field,\n              xOff,\n              yOff,\n              newRotation\n            );            \n            \n            if (!collision.combined) {\n              legalPosition = true;\n              break;\n            }\n\n            if (collision.outOfBounds.bottom) yOff--;\n            if (collision.outOfBounds.top) yOff++;\n            if (collision.outOfBounds.left) xOff++;\n            if (collision.outOfBounds.right) xOff--;\n          }\n\n          if (legalPosition) {\n            onPlayerMove({\n              ...player,\n              block: {\n                ...player.block,\n                x: player.block.x + xOff,\n                y: player.block.y + yOff,\n                rotation: newRotation,\n              },\n            });\n          }\n          break;\n        case \" \":\n          //event.preventDefault();\n          let yDiff = 0;\n          while (!evalCollision(player.block, field, 0, yDiff).combined) {\n            yDiff++;\n          }\n          onPlayerMove({\n            ...player,\n            block: { ...player.block, y: player.block.y + (yDiff - 1) },\n          });\n          break;\n      }\n    },\n    [field, player, onPlayerMove]\n  );\n\n  /**\n   * Regiser keydown event handler\n   */\n  useEffect(() => {\n    window.addEventListener(\"keydown\", onKeyDownHandler);\n    // Remove event listeners on cleanup\n    return () => {\n      window.removeEventListener(\"keydown\", onKeyDownHandler);\n    };\n  }, [onKeyDownHandler]);\n\n  return (\n    <Canvas\n      width={field[0].length * block_size}\n      height={field.length * block_size}\n      field={gamefieldDisplay}\n      blockSize={block_size}\n      players={[...players, player]}\n    />\n  );\n};\n","import React, { useState } from \"react\";\nimport { ChatMessage } from \"../types\";\n\ninterface Props {\n  messages: ChatMessage[];\n  userId: string;\n  onMessage: (message: ChatMessage) => void;\n}\n\nexport const Chat: React.FC<Props> = (props: Props) => {\n  const [msg, setMsg] = useState(\"\");\n\n  const sendMessage = () => {\n    if (msg.length > 0) {\n      props.onMessage({\n        id: props.userId,\n        message: msg,\n      });\n      setMsg(\"\");\n    }\n  };\n\n  return (\n    <div className=\"chat-container\">\n      <div className=\"chat-message-container\">\n        {props.messages.map((message, index) => (\n          <div\n            key={index}\n            className={message.id === props.userId ? \"chat-right\" : \"chat-left\"}\n          >\n            <div className=\"chat-message\">{message.message}</div>\n          </div>\n        ))}\n      </div>\n      <form\n        onSubmit={(e: any) => {\n          e.preventDefault();\n          sendMessage();\n        }}\n      >\n        <div className=\"input-group\">\n          <input\n            type=\"text\"\n            className=\"form-control\"\n            placeholder=\"Message...\"\n            value={msg}\n            onChange={(e) => setMsg(e.target.value)}\n          />\n          <div className=\"input-group-append\">\n            <button\n              className=\"btn btn-primary\"\n              type=\"submit\"\n              onClick={sendMessage}\n            >\n              Send\n            </button>\n          </div>\n        </div>\n      </form>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { ChatMessage } from \"../types\";\nimport { Chat } from \"./Chat\";\n\ninterface Props {\n  messages: ChatMessage[];\n  userId: string;\n  onMessage: (message: ChatMessage) => void;\n  players: { username: string; id: string, ready: boolean }[];\n}\n\nexport const LobbyInfo: React.FC<Props> = (props: Props) => {\n  const [tab, setTab] = React.useState<\"players\" | \"chat\">(\"players\");  \n\n  return (\n    <div className=\"w-300 card\">\n      <div className=\"tab-header\">\n        <span\n          className={tab === \"players\" ? \"tab-item-selected\" : \"tab-item\"}\n          onClick={() => setTab(\"players\")}\n        >\n          Players\n        </span>\n        <span\n          className={tab === \"chat\" ? \"tab-item-selected\" : \"tab-item\"}\n          onClick={() => setTab(\"chat\")}\n        >\n          Chat\n        </span>\n      </div>\n      {tab === \"players\" && (\n        <div>\n          {props.players.map((player, index) => (\n            <div className=\"player-item\" key={index}>\n              <span>{player.username}</span>\n                <span className={player.ready? \"player-item-ready\" : \"\"}/>\n              </div>\n          ))}\n        </div>\n      )}\n      {tab === \"chat\" && (\n        <Chat\n          messages={props.messages}\n          userId={props.userId}\n          onMessage={props.onMessage}\n        />\n      )}\n    </div>\n  );\n};\n","import React, { useEffect, useRef, useState } from \"react\";\nimport { randomBlock } from \"../tetris/blocks\";\nimport { ChatMessage, Colors, PlayerEntry, SocketAddress } from \"../types\";\nimport { Tetris } from \"./Tetris\";\nimport io from \"socket.io-client\";\nimport { LobbyInfo } from \"./LobbyInfo\";\nimport { useParams } from \"react-router\";\nimport { deleteLobby, getLobby, migrateLobby } from \"../api/lobby\";\nimport { updateUserStats } from \"../api/account\";\n\nconst fieldSize = { x: 30, y: 20 };\nconst username = localStorage.getItem(\"username\") || \"Jaqen H'ghar\";\nconst id = localStorage.getItem(\"userId\") || \"error_id\" + Math.random();\n\ninterface Props {}\n\nexport const TetrisSocket: React.FC<Props> = (props: Props) => {\n  const { room } = useParams<any>();\n\n  const initPlayer = {\n    id: id,\n    username: username,\n    block: randomBlock(randInt(0, fieldSize.x - 3)),\n    ready: false,\n  };\n\n  const [player, setPlayer] = useState<PlayerEntry>(initPlayer);\n  const [players, setPlayers] = useState<PlayerEntry[]>([]);\n  const [field, setField] = useState(genEmptyField(fieldSize.x, fieldSize.y));\n  const [chatMessages, setChatMessages] = useState<ChatMessage[]>([]);\n  const [playerReady, setPlayerReady] = useState(false);\n  const [gameRunning, setGameRunning] = useState(false);\n  const [gameOver, setGameOver] = useState(false);\n  const [lobbyText, setLobbyText] = useState(\"Waiting for other players...\");\n  const [lobbyName, setLobbyName] = useState(\"\");\n  const [socketAddress, setSocketAddress] = useState<SocketAddress>();\n  const [socket, setSocket] = useState<any>(null);\n  const startTime = useRef(0);\n  const blockFixCount = useRef(0);\n\n  useEffect(() => {\n    //Get the lobbys assigned game-server\n    getLobby(room).then((response) => {\n      setSocketAddress({ ip: response.data.ip, port: response.data.port });\n      setLobbyName(response.data.name);\n    });\n  }, [room]);\n\n  useEffect(() => {\n    let newSocket: any;\n\n    console.log(\"NEW SOCKET\", socketAddress);\n\n    if (socketAddress) {\n      newSocket = io(`ws://${socketAddress.ip}:${socketAddress.port}`);\n      console.log(\"CONNECTED\");\n      setSocket(newSocket);\n    }\n\n    return () => {\n      if (newSocket) {\n        newSocket.close();\n      }\n    };\n  }, [socketAddress]);\n\n  useEffect(() => {\n    if (socket) {\n      socket.on(\"connect\", () => {\n        console.log(\"Connected to server\");\n        if (players.length !== 0) {\n          console.log(\"SENDING PLAYERS\");\n          socket.emit(\"migrate\", { room, field, players });\n        }\n        console.log(\"JOIN\");\n        socket.emit(\"join\", { room, username: username, id: id });\n      });\n    }\n  }, [socket, players, field, room]);\n\n  /**\n   * React to socket events\n   */\n  useEffect(() => {\n    if (!socket) return;\n\n    socket.on(\"disconnect\", () => {\n      // All players will send a migrate event when they disconnect with a random delay\n      setTimeout(() => {\n        if (socketAddress) {\n          deleteLobby(room, socketAddress.ip, socketAddress.port).then(() => {\n            console.log(\"DELETED\");\n            migrateLobby(room, socketAddress, lobbyName).then((response: any) => {\n              console.log(\"MIGRATED\", response);\n              console.log(\n                \"MIGRATE\",\n                response,\n                response.data.ip,\n                response.data.port\n              );\n              setSocketAddress({\n                ip: response.data.ip,\n                port: response.data.port,\n              });\n            }).catch((error: any) => console.log(error));\n          }).catch((error: any) => console.log(error));\n        }\n      }, Math.random() * 1000);\n    });\n\n    // New player joins\n    socket.on(\"onJoin\", (response: any) => {\n      setPlayers(response.players);\n      if(response.field.length !== 0) {        \n        setField(response.field);\n      }\n    });\n\n    // New player joins\n    socket.on(\"onLeave\", (response: any) => {\n      setPlayers(response);\n    });\n\n    // Player updates\n    socket.on(\"onPlayerUpdate\", (response: any) => {\n      setPlayers(response);\n    });\n\n    // Field update\n    socket.on(\"onFieldUpdate\", (response: any) => {\n      setField(response);\n    });\n\n    // Chat message\n    socket.on(\"onChatMessage\", (response: any) => {\n      setChatMessages((messages) => [...messages, response.message]);\n    });\n\n    // Player ready\n    socket.on(\"onPlayerReady\", (response: any) => {\n      setPlayers(response);\n    });\n\n    socket.on(\"onGameStart\", (response: any) => {\n      setGameRunning(true);\n      startTime.current = Date.now();\n    });\n\n    socket.on(\"onGameOver\", (response: any) => {\n      setLobbyText(`Game over! Score: ${response.score}`);\n      setGameOver(true);\n      setGameRunning(false);\n\n      const passedTime = ((Date.now() - startTime.current)/1000)/60;\n      const blocksPerMinute = blockFixCount.current/passedTime;\n\n      const stats = {\n        bpm: blocksPerMinute,\n        score: response.score,\n        time: Date.now(),\n      };      \n\n      updateUserStats(stats);\n      deleteLobby(room, socketAddress!.ip, socketAddress!.port);\n    });\n  }, [socket, room, socketAddress, lobbyName]);\n\n  const onBlockFix = (newField: Colors[][]) => {\n    setField(newField);\n    setPlayer((player) => {\n      player.block = randomBlock(randInt(0, fieldSize.x - 4));\n      return player;\n    });\n    blockFixCount.current++;\n    socket.emit(\"fieldUpdate\", { room, field: newField });\n  };\n\n  const onPlayerMove = (newPlayer: PlayerEntry) => {    \n    setPlayer(newPlayer);\n    socket.emit(\"playerUpdate\", {\n      room,\n      id: id,\n      block: newPlayer.block,\n    });\n  };\n\n  const sendChatMessage = (message: ChatMessage) => {\n    socket.emit(\"chatMessage\", { room, msg: message });\n  };\n\n  const onReady = () => {\n    setPlayerReady(true);\n    socket.emit(\"playerReady\", { room, id: id });\n  };\n\n  return (\n    <div className=\"gameContainer\">\n      <LobbyInfo\n        messages={chatMessages}\n        onMessage={sendChatMessage}\n        userId={id}\n        players={players.map((p) => {\n          return { username: p.username, id: p.id, ready: p.ready };\n        })}\n      />\n      {gameRunning && (\n        <Tetris\n          field={field}\n          player={player}\n          players={players.filter((p) => p.id !== id)}\n          onPlayerMove={onPlayerMove}\n          onBlockFix={onBlockFix}\n        ></Tetris>\n      )}\n      {!gameRunning && (\n        <div className=\"waiting-container\">\n          <p className=\"waiting-text\">{lobbyText}</p>\n          {!playerReady && (\n            <button className=\"btn btn-primary\" onClick={onReady}>\n              Ready\n            </button>\n          )}\n          {gameOver && (\n            <a href=\"/\">\n              <button className=\"btn btn-primary\" onClick={onReady}>\n                Continue\n              </button>\n            </a>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\n//min,max (inclusive)\nconst randInt = (min: number, max: number) => {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\nconst genEmptyField = (width: number, height: number) => {\n  let f = new Array<Colors[]>(fieldSize.y);\n\n  for (var i = 0; i < f.length; i++) {\n    f[i] = new Array<Colors>(fieldSize.x).fill(Colors.EMPTY);\n  }\n\n  return f;\n};\n","import React, { useEffect, useState } from \"react\";\nimport { search } from \"../api/search\";\n\ninterface Props {}\n\nexport const Search: React.FC<Props> = (props: Props) => {\n  type Result = {\n    id: string;\n    username: string;\n    highscore: number;\n  };\n\n  const [query, setQuery] = useState(\"\");\n  const [results, setResults] = useState<Result[]>([]);\n\n  useEffect(() => {\n    if (query.length > 0) {\n      search(query)\n        .then((response) => {          \n          setResults(response.data.users);\n        })\n        .catch(() => {\n          setResults([]);\n        });\n    }\n  }, [query]);\n\n  return (\n    <div className=\"container-sm\" style={{ padding: \"2em\" }}>\n      <input\n        type=\"text\"\n        className=\"form-control\"\n        placeholder=\"Search...\"\n        value={query}\n        onChange={(e) => setQuery(e.target.value)}\n      ></input>\n      <div className=\"searchResultsContainer\">\n        {results.length <= 0 && <p className=\"noResults\">No results found.</p>}\n        {results.map((result, index) => (\n          <SearchResult\n            username={result.username}\n            highscore={result.highscore}\n            id={result.id}\n            key={`search_result_${index}`}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\ninterface SearchResultsProps {\n  username: string;\n  highscore: number;\n  id: string;\n}\n\nconst SearchResult: React.FC<SearchResultsProps> = (\n  props: SearchResultsProps\n) => {\n  return (\n    <div className=\"w-400 mw-full\">\n      <div className=\"card\">\n        <h2 className=\"card-title\">{props.username}</h2>\n        <p>\n          Highscore :{\" \"}\n          <span className=\"badge badge-primary\">{props.highscore}</span>\n        </p>\n        <div className=\"text-right\">\n          <a href={`user/${props.id}`} className=\"btn btn-primary\">\n            Profile\n          </a>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import axios from \"axios\";\nimport { requestEndpoint } from \"./endpoint\";\n\nexport const search = (query: string) => {\n  return requestEndpoint().then((endpoint) => {\n    return axios.get(`${endpoint}/api/user/search`, {\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(\"auth\")}`,\n      },\n      params: {\n        query,\n      },\n    });\n  });\n};\n","import { useEffect, useState } from \"react\";\nimport { Navbar } from \"./components/Navbar\";\nimport \"./index.css\";\nimport \"halfmoon/css/halfmoon-variables.min.css\";\nimport { SignIn } from \"./components/SignIn\";\nimport { BrowserRouter, Switch, Route } from \"react-router-dom\";\nimport { Lobbies } from \"./components/Lobbies\";\nimport { SignUp } from \"./components/SignUp\";\nimport { Account } from \"./components/Account\";\nimport { Authenticated } from \"./components/Authenticated\";\nimport { isAuthenticated } from \"./api/account\";\nimport { TetrisSocket } from \"./components/TetrisSocket\";\nimport { Search } from \"./components/Search\";\n\nfunction App() {\n  const halfmoon = require(\"halfmoon\");\n\n  useEffect(() => {\n    halfmoon.onDOMContentLoaded();\n  }, [halfmoon]);\n\n  const [isAuth, setAuth] = useState(true);\n\n  useEffect(() => {\n    isAuthenticated()\n      .then((response) => setAuth(response.data.message === \"Success\"))\n      .catch(() => setAuth(false));\n  }, []);\n\n  return (\n    <div className=\"App\">\n      <Navbar\n        authenticated={isAuth}\n        buttonText={isAuth ? \"Account\" : \"Sign in\"}\n      >\n        <BrowserRouter>\n          <Switch>\n            <Route path=\"/signin\">\n              <SignIn onAuthenticated={() => setAuth(true)} />\n            </Route>\n            <Route path=\"/signup\">\n              <SignUp onAuthenticated={() => setAuth(true)} />\n            </Route>\n            <Authenticated\n              authenticated={isAuth}\n              onAuthenticated={() => setAuth(true)}\n            >\n              <Route path=\"/account\" component={Account} />\n              <Route path=\"/user/:id\" component={Account} />\n              <Route path=\"/lobby/:room\" component={TetrisSocket} />\n              <Route path=\"/\" component={Lobbies} exact />\n              <Route path=\"/search\" component={Search} />\n            </Authenticated>\n          </Switch>\n        </BrowserRouter>\n      </Navbar>\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}